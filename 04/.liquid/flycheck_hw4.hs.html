<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/Users/matt/Dropbox/cis194/04/flycheck_hw4.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Hw4</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 2: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>List</span>
<span class=hs-linenum> 3: </span>
<span class=hs-linenum> 4: </span><span class='hs-comment'>-- Exercise 1</span>
<span class=hs-linenum> 5: </span><span class='hs-definition'>fun1</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Integer</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<span class=hs-linenum> 6: </span><a class=annot href="#"><span class=annottext>[GHC.Integer.Type.Integer] -&gt; GHC.Integer.Type.Integer</span><span class='hs-definition'>fun1</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span>
<span class=hs-linenum> 7: </span><span class='hs-definition'>fun1</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 8: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer -&gt; GHC.Types.Bool</span><span class='hs-varid'>even</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == x}</span><span class='hs-varid'>x</span></a>    <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Integer.Type.Integer | v == x1 - x2}</span><span class='hs-comment'>-</span></a> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Integer.Type.Integer | x1 &gt; 0 &amp;&amp; x2 &gt; 0 =&gt; v &gt;= x1 &amp;&amp; v &gt;= x2 &amp;&amp; x1 &gt; 1 &amp;&amp; x2 &gt; 1 =&gt; v &gt; x1 &amp;&amp; v &gt; x2 &amp;&amp; x1 == 0 || x2 == 0 =&gt; v == 0}</span><span class='hs-varop'>*</span></a> <a class=annot href="#"><span class=annottext>[GHC.Integer.Type.Integer] -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>fun1</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Integer.Type.Integer] | v == xs &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 9: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Integer.Type.Integer] -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>fun1</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Integer.Type.Integer] | v == xs &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>10: </span>
<span class=hs-linenum>11: </span><span class='hs-definition'>fun1'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Integer</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<span class=hs-linenum>12: </span><a class=annot href="#"><span class=annottext>[GHC.Integer.Type.Integer] -&gt; GHC.Integer.Type.Integer</span><span class='hs-definition'>fun1'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Integer.Type.Integer] -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>product</span></a> <a class=annot href="#"><span class=annottext>([GHC.Integer.Type.Integer] -&gt; GHC.Integer.Type.Integer)
-&gt; ([GHC.Integer.Type.Integer] -&gt; [GHC.Integer.Type.Integer])
-&gt; [GHC.Integer.Type.Integer]
-&gt; exists [[GHC.Integer.Type.Integer]].GHC.Integer.Type.Integer</span><span class='hs-varop'>.</span></a> <a class=annot href="#"><span class=annottext>(GHC.Integer.Type.Integer -&gt; GHC.Integer.Type.Integer)
-&gt; x3:[GHC.Integer.Type.Integer]
-&gt; {v : [GHC.Integer.Type.Integer] | len v == len x3}</span><span class='hs-varid'>map</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(GHC.Integer.Type.Integer
 -&gt; GHC.Integer.Type.Integer -&gt; GHC.Integer.Type.Integer)
-&gt; GHC.Integer.Type.Integer
-&gt; GHC.Integer.Type.Integer
-&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>flip</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Integer.Type.Integer | v == x1 - v}</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>([GHC.Integer.Type.Integer] -&gt; [GHC.Integer.Type.Integer])
-&gt; ([GHC.Integer.Type.Integer] -&gt; [GHC.Integer.Type.Integer])
-&gt; [GHC.Integer.Type.Integer]
-&gt; exists [[GHC.Integer.Type.Integer]].[GHC.Integer.Type.Integer]</span><span class='hs-varop'>.</span></a> <a class=annot href="#"><span class=annottext>(GHC.Integer.Type.Integer -&gt; GHC.Types.Bool)
-&gt; x3:[GHC.Integer.Type.Integer]
-&gt; {v : [GHC.Integer.Type.Integer] | len v &lt;= len x3}</span><span class='hs-varid'>filter</span></a> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer -&gt; GHC.Types.Bool</span><span class='hs-varid'>even</span></a>
<span class=hs-linenum>13: </span>
<span class=hs-linenum>14: </span><span class='hs-definition'>fun2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<span class=hs-linenum>15: </span><a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer -&gt; GHC.Integer.Type.Integer</span><span class='hs-definition'>fun2</span></a> <span class='hs-num'>1</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>0</span>
<span class=hs-linenum>16: </span><span class='hs-definition'>fun2</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer -&gt; GHC.Types.Bool</span><span class='hs-varid'>even</span></a> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-varid'>n</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Integer.Type.Integer | v == x1 + x2}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>fun2</span></a> <span class='hs-layout'>(</span><span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-varid'>n</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:{v : GHC.Integer.Type.Integer | v /= 0}
-&gt; {v : GHC.Integer.Type.Integer | x1 &gt;= 0 &amp;&amp; x2 &gt;= 0 =&gt; v &gt;= 0 &amp;&amp; x1 &gt;= 0 &amp;&amp; x2 &gt;= 1 =&gt; v &lt;= x1 &amp;&amp; v == x1 / x2}</span><span class='hs-varop'>`div`</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-num'>2</span></span><span class='hs-layout'>)</span>
<span class=hs-linenum>17: </span>       <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>fun2</span></a> <span class='hs-layout'>(</span><span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-num'>3</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Integer.Type.Integer | x1 &gt; 0 &amp;&amp; x2 &gt; 0 =&gt; v &gt;= x1 &amp;&amp; v &gt;= x2 &amp;&amp; x1 &gt; 1 &amp;&amp; x2 &gt; 1 =&gt; v &gt; x1 &amp;&amp; v &gt; x2 &amp;&amp; x1 == 0 || x2 == 0 =&gt; v == 0}</span><span class='hs-varop'>*</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-varid'>n</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Integer.Type.Integer | v == x1 + x2}</span><span class='hs-varop'>+</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-num'>1</span></span><span class='hs-layout'>)</span>
<span class=hs-linenum>18: </span>
<span class=hs-linenum>19: </span><span class='hs-definition'>fun2'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<span class=hs-linenum>20: </span><a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer -&gt; GHC.Integer.Type.Integer</span><span class='hs-definition'>fun2'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Integer.Type.Integer] -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>sum</span></a> <a class=annot href="#"><span class=annottext>([GHC.Integer.Type.Integer] -&gt; GHC.Integer.Type.Integer)
-&gt; (GHC.Integer.Type.Integer -&gt; [GHC.Integer.Type.Integer])
-&gt; GHC.Integer.Type.Integer
-&gt; exists [[GHC.Integer.Type.Integer]].GHC.Integer.Type.Integer</span><span class='hs-varop'>.</span></a> <a class=annot href="#"><span class=annottext>(GHC.Integer.Type.Integer -&gt; GHC.Types.Bool)
-&gt; x3:[GHC.Integer.Type.Integer]
-&gt; {v : [GHC.Integer.Type.Integer] | len v &lt;= len x3}</span><span class='hs-varid'>filter</span></a> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer -&gt; GHC.Types.Bool</span><span class='hs-varid'>even</span></a> <a class=annot href="#"><span class=annottext>([GHC.Integer.Type.Integer] -&gt; [GHC.Integer.Type.Integer])
-&gt; (GHC.Integer.Type.Integer -&gt; [GHC.Integer.Type.Integer])
-&gt; GHC.Integer.Type.Integer
-&gt; exists [[GHC.Integer.Type.Integer]].[GHC.Integer.Type.Integer]</span><span class='hs-varop'>.</span></a> <a class=annot href="#"><span class=annottext>(GHC.Integer.Type.Integer -&gt; GHC.Types.Bool)
-&gt; x3:[GHC.Integer.Type.Integer]
-&gt; {v : [GHC.Integer.Type.Integer] | len v &lt;= len x3}</span><span class='hs-varid'>takeWhile</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Types.Bool | Prop v &lt;=&gt; x1 /= v}</span><span class='hs-varop'>/=</span></a> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>([GHC.Integer.Type.Integer] -&gt; [GHC.Integer.Type.Integer])
-&gt; (GHC.Integer.Type.Integer -&gt; [GHC.Integer.Type.Integer])
-&gt; GHC.Integer.Type.Integer
-&gt; exists [[GHC.Integer.Type.Integer]].[GHC.Integer.Type.Integer]</span><span class='hs-varop'>.</span></a> <a class=annot href="#"><span class=annottext>(GHC.Integer.Type.Integer -&gt; GHC.Integer.Type.Integer)
-&gt; GHC.Integer.Type.Integer -&gt; [GHC.Integer.Type.Integer]</span><span class='hs-varid'>iterate</span></a> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>f</span></a>
<span class=hs-linenum>21: </span>  <span class='hs-keyword'>where</span> <a class=annot href="#"><span class=annottext>forall a. (GHC.Real.Integral [Bivariant]
[] a) =&gt; a -&gt; a</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-keyword'>if</span></a> <a class=annot href="#"><span class=annottext>a -&gt; GHC.Types.Bool</span><span class='hs-varid'>even</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>x1:a
-&gt; x2:{VV : a | VV /= 0}
-&gt; {VV : a | x1 &gt;= 0 &amp;&amp; x2 &gt;= 0 =&gt; VV &gt;= 0 &amp;&amp; x1 &gt;= 0 &amp;&amp; x2 &gt;= 1 =&gt; VV &lt;= x1 &amp;&amp; VV == x1 / x2}</span><span class='hs-varop'>`div`</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-num'>2</span></a> <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-num'>3</span></a><a class=annot href="#"><span class=annottext>x1:a
-&gt; x2:a
-&gt; {VV : a | x1 &gt; 0 &amp;&amp; x2 &gt; 0 =&gt; VV &gt;= x1 &amp;&amp; VV &gt;= x2 &amp;&amp; x1 &gt; 1 &amp;&amp; x2 &gt; 1 =&gt; VV &gt; x1 &amp;&amp; VV &gt; x2 &amp;&amp; x1 == 0 || x2 == 0 =&gt; VV == 0}</span><span class='hs-varop'>*</span></a><a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>x1:a -&gt; x2:a -&gt; {VV : a | VV == x1 + x2}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-num'>1</span></a>
<span class=hs-linenum>22: </span>
<span class=hs-linenum>23: </span>
<span class=hs-linenum>24: </span><span class='hs-comment'>-- Exercise 2</span>
<span class=hs-linenum>25: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Tree</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Leaf</span>
<span class=hs-linenum>26: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Node</span> <span class='hs-conid'>Integer</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tree</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tree</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>27: </span>            <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a.
(GHC.Show.Show [Contravariant]
[] a) =&gt;
(GHC.Show.Show (Hw4.Tree a))</span><span class='hs-conid'>Show</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>forall a.
(GHC.Classes.Eq [Contravariant]
[] a) =&gt;
(GHC.Classes.Eq (Hw4.Tree a))</span><span class='hs-conid'>Eq</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>28: </span>
<span class=hs-linenum>29: </span><span class='hs-definition'>insElem</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Tree</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Tree</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>30: </span><a class=annot href="#"><span class=annottext>forall a. a -&gt; (Hw4.Tree a) -&gt; (Hw4.Tree a)</span><span class='hs-definition'>insElem</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>e</span></a> <span class='hs-conid'>Leaf</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer
-&gt; (Hw4.Tree a) -&gt; a -&gt; (Hw4.Tree a) -&gt; (Hw4.Tree a)</span><span class='hs-conid'>Node</span></a> <span class='hs-num'>0</span> <a class=annot href="#"><span class=annottext>(Hw4.Tree a)</span><span class='hs-conid'>Leaf</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>(Hw4.Tree a)</span><span class='hs-conid'>Leaf</span></a>
<span class=hs-linenum>31: </span><span class='hs-definition'>insElem</span> <span class='hs-varid'>e</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>h</span> <span class='hs-varid'>l</span> <span class='hs-varid'>e'</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<span class=hs-linenum>32: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>(Hw4.Tree a) -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>height</span></a> <a class=annot href="#"><span class=annottext>{v : (Hw4.Tree a) | v == l}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Types.Bool | Prop v &lt;=&gt; x1 &lt; v}</span><span class='hs-varop'>&lt;</span></a> <a class=annot href="#"><span class=annottext>(Hw4.Tree a) -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>height</span></a> <a class=annot href="#"><span class=annottext>{v : (Hw4.Tree a) | v == r}</span><span class='hs-varid'>r</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>33: </span>      <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>(Hw4.Tree a)</span><span class='hs-varid'>l'</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a. a -&gt; (Hw4.Tree a) -&gt; (Hw4.Tree a)</span><span class='hs-varid'>insElem</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v : (Hw4.Tree a) | v == l}</span><span class='hs-varid'>l</span></a><span class='hs-layout'>)</span> <span class='hs-keyword'>in</span>
<span class=hs-linenum>34: </span>      <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer
-&gt; (Hw4.Tree a) -&gt; a -&gt; (Hw4.Tree a) -&gt; (Hw4.Tree a)</span><span class='hs-conid'>Node</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Hw4.Tree a) -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>height</span></a> <a class=annot href="#"><span class=annottext>{v : (Hw4.Tree a) | v == l'}</span><span class='hs-varid'>l'</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (Hw4.Tree a) | v == l'}</span><span class='hs-varid'>l'</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v : (Hw4.Tree a) | v == r}</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum>35: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>(Hw4.Tree a) -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>height</span></a> <a class=annot href="#"><span class=annottext>{v : (Hw4.Tree a) | v == r}</span><span class='hs-varid'>r</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Types.Bool | Prop v &lt;=&gt; x1 &lt; v}</span><span class='hs-varop'>&lt;</span></a> <a class=annot href="#"><span class=annottext>(Hw4.Tree a) -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>height</span></a> <a class=annot href="#"><span class=annottext>{v : (Hw4.Tree a) | v == l}</span><span class='hs-varid'>l</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>36: </span>      <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>(Hw4.Tree a)</span><span class='hs-varid'>r'</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>forall a. a -&gt; (Hw4.Tree a) -&gt; (Hw4.Tree a)</span><span class='hs-varid'>insElem</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == e}</span><span class='hs-varid'>e</span></a> <a class=annot href="#"><span class=annottext>{v : (Hw4.Tree a) | v == r}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span> <span class='hs-keyword'>in</span>
<span class=hs-linenum>37: </span>      <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer
-&gt; (Hw4.Tree a) -&gt; a -&gt; (Hw4.Tree a) -&gt; (Hw4.Tree a)</span><span class='hs-conid'>Node</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Hw4.Tree a) -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>height</span></a> <a class=annot href="#"><span class=annottext>{v : (Hw4.Tree a) | v == r'}</span><span class='hs-varid'>r'</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (Hw4.Tree a) | v == l}</span><span class='hs-varid'>l</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == e'}</span><span class='hs-varid'>e'</span></a> <a class=annot href="#"><span class=annottext>{v : (Hw4.Tree a) | v == r'}</span><span class='hs-varid'>r'</span></a>
<span class=hs-linenum>38: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>39: </span>    <a class=annot href="#"><span class=annottext>forall a. (Hw4.Tree a) -&gt; GHC.Integer.Type.Integer</span><span class='hs-varid'>height</span></a> <span class='hs-conid'>Leaf</span>           <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 1}</span><span class='hs-comment'>-</span></a><span class='hs-num'>1</span>
<span class=hs-linenum>40: </span>    <span class='hs-varid'>height</span> <span class='hs-layout'>(</span><span class='hs-conid'>Node</span> <span class='hs-varid'>h</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == h}</span><span class='hs-varid'>h</span></a>
<span class=hs-linenum>41: </span>
<span class=hs-linenum>42: </span><span class='hs-definition'>foldTree</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Tree</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>43: </span><a class=annot href="#"><span class=annottext>forall a. [a] -&gt; (Hw4.Tree a)</span><span class='hs-definition'>foldTree</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a -&gt; (Hw4.Tree a) -&gt; (Hw4.Tree a))
-&gt; (Hw4.Tree a) -&gt; [a] -&gt; (Hw4.Tree a)</span><span class='hs-varid'>foldr</span></a> <a class=annot href="#"><span class=annottext>a -&gt; (Hw4.Tree a) -&gt; (Hw4.Tree a)</span><span class='hs-varid'>insElem</span></a> <a class=annot href="#"><span class=annottext>(Hw4.Tree a)</span><span class='hs-conid'>Leaf</span></a>
<span class=hs-linenum>44: </span>
<span class=hs-linenum>45: </span>
<span class=hs-linenum>46: </span><span class='hs-comment'>-- Exercise 3</span>
<span class=hs-linenum>47: </span><span class='hs-definition'>xor</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Bool</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>48: </span><a class=annot href="#"><span class=annottext>[GHC.Types.Bool] -&gt; GHC.Types.Bool</span><span class='hs-definition'>xor</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; GHC.Types.Bool</span><span class='hs-varid'>odd</span></a> <a class=annot href="#"><span class=annottext>(GHC.Types.Int -&gt; GHC.Types.Bool)
-&gt; ([GHC.Types.Bool] -&gt; GHC.Types.Int)
-&gt; [GHC.Types.Bool]
-&gt; exists [GHC.Types.Int].GHC.Types.Bool</span><span class='hs-varop'>.</span></a> <a class=annot href="#"><span class=annottext>x1:[GHC.Types.Bool] -&gt; {v : GHC.Types.Int | v == len x1}</span><span class='hs-varid'>length</span></a> <a class=annot href="#"><span class=annottext>([GHC.Types.Bool] -&gt; GHC.Types.Int)
-&gt; ([GHC.Types.Bool] -&gt; [GHC.Types.Bool])
-&gt; [GHC.Types.Bool]
-&gt; exists [[GHC.Types.Bool]].GHC.Types.Int</span><span class='hs-varop'>.</span></a> <a class=annot href="#"><span class=annottext>(GHC.Types.Bool -&gt; [GHC.Types.Bool] -&gt; [GHC.Types.Bool])
-&gt; [GHC.Types.Bool] -&gt; [GHC.Types.Bool] -&gt; [GHC.Types.Bool]</span><span class='hs-varid'>foldr</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Bool -&gt; [GHC.Types.Bool] -&gt; [GHC.Types.Bool]</span><span class='hs-keyglyph'>\</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Bool]</span><span class='hs-varid'>a</span></a> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v == x}</span><span class='hs-varid'>x</span></a><a class=annot href="#"><span class=annottext>x1:GHC.Types.Bool
-&gt; x2:[GHC.Types.Bool]
-&gt; {v : [GHC.Types.Bool] | null v &lt;=&gt; false &amp;&amp; xListSelector v == x1 &amp;&amp; len v == 1 + len x2 &amp;&amp; xsListSelector v == x2}</span><span class='hs-conop'>:</span></a><a class=annot href="#"><span class=annottext>{v : [GHC.Types.Bool] | v == a &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>a</span></a> <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Bool] | v == a &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>a</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Bool] | null v &lt;=&gt; true &amp;&amp; len v == 0 &amp;&amp; len v &gt;= 0}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>49: </span>
<span class=hs-linenum>50: </span><span class='hs-definition'>map'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>b</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>51: </span><a class=annot href="#"><span class=annottext>forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]</span><span class='hs-definition'>map'</span></a> <a class=annot href="#"><span class=annottext>a -&gt; b</span><span class='hs-varid'>f</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a -&gt; [b] -&gt; [b]) -&gt; [b] -&gt; [a] -&gt; [b]</span><span class='hs-varid'>foldr</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>x1:a
-&gt; x2:[a]
-&gt; {v : [a] | null v &lt;=&gt; false &amp;&amp; xListSelector v == x1 &amp;&amp; len v == 1 + len x2 &amp;&amp; xsListSelector v == x2}</span><span class='hs-layout'>(</span></a><span class='hs-conop'>:</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(a -&gt; [a] -&gt; [a]) -&gt; (b -&gt; a) -&gt; b -&gt; exists [a].[a] -&gt; [a]</span><span class='hs-varop'>.</span></a> <a class=annot href="#"><span class=annottext>a -&gt; b</span><span class='hs-varid'>f</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [a] | null v &lt;=&gt; true &amp;&amp; len v == 0 &amp;&amp; len v &gt;= 0}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>52: </span>
<span class=hs-linenum>53: </span><span class='hs-definition'>myFoldl</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>b</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>54: </span><a class=annot href="#"><span class=annottext>forall a b. (a -&gt; b -&gt; a) -&gt; a -&gt; [b] -&gt; a</span><span class='hs-definition'>myFoldl</span></a> <a class=annot href="#"><span class=annottext>a -&gt; b -&gt; a</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a -&gt; (b -&gt; b) -&gt; b -&gt; b) -&gt; (b -&gt; b) -&gt; [a] -&gt; b -&gt; b</span><span class='hs-varid'>foldr</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a -&gt; (b -&gt; b) -&gt; b -&gt; b</span><span class='hs-keyglyph'>\</span></a><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>a -&gt; a</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>b</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>a -&gt; a</span><span class='hs-varid'>a</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a -&gt; b -&gt; a</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == b}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>x1:a -&gt; {VV : a | VV == x1}</span><span class='hs-varid'>id</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == b}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum>55: </span>
<span class=hs-linenum>56: </span>
<span class=hs-linenum>57: </span><span class='hs-comment'>-- Exercise 4</span>
<span class=hs-linenum>58: </span><span class='hs-definition'>sieveSundaram</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Integer</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>59: </span><a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer -&gt; [GHC.Integer.Type.Integer]</span><span class='hs-definition'>sieveSundaram</span></a> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-varid'>n</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Integer.Type.Integer -&gt; GHC.Integer.Type.Integer)
-&gt; x3:[GHC.Integer.Type.Integer]
-&gt; {v : [GHC.Integer.Type.Integer] | len v == len x3}</span><span class='hs-varid'>map</span></a>  <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer
-&gt; exists [GHC.Integer.Type.Integer].GHC.Integer.Type.Integer</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Integer.Type.Integer | v == x1 + x2}</span><span class='hs-varop'>+</span></a><span class='hs-num'>1</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(GHC.Integer.Type.Integer -&gt; GHC.Integer.Type.Integer)
-&gt; (GHC.Integer.Type.Integer -&gt; GHC.Integer.Type.Integer)
-&gt; GHC.Integer.Type.Integer
-&gt; exists [GHC.Integer.Type.Integer].GHC.Integer.Type.Integer</span><span class='hs-varop'>.</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Integer.Type.Integer | x1 &gt; 0 &amp;&amp; x2 &gt; 0 =&gt; v &gt;= x1 &amp;&amp; v &gt;= x2 &amp;&amp; x1 &gt; 1 &amp;&amp; x2 &gt; 1 =&gt; v &gt; x1 &amp;&amp; v &gt; x2 &amp;&amp; x1 == 0 || x2 == 0 =&gt; v == 0}</span><span class='hs-varop'>*</span></a><span class='hs-num'>2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>([GHC.Integer.Type.Integer] -&gt; [GHC.Integer.Type.Integer])
-&gt; [GHC.Integer.Type.Integer] -&gt; [GHC.Integer.Type.Integer]</span><span class='hs-varop'>$</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Integer.Type.Integer] | len v &gt;= 0}</span><span class='hs-keyglyph'>[</span></a><span class='hs-num'>1</span><span class='hs-keyglyph'>..</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == n}</span><span class='hs-varid'>n</span></a><span class='hs-keyglyph'>]</span> <a class=annot href="#"><span class=annottext>[GHC.Integer.Type.Integer]
-&gt; [GHC.Integer.Type.Integer] -&gt; [GHC.Integer.Type.Integer]</span><span class='hs-varop'>\\</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Integer.Type.Integer] | v == rm &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>rm</span></a>
<span class=hs-linenum>60: </span>  <span class='hs-keyword'>where</span> <a class=annot href="#"><span class=annottext>[GHC.Integer.Type.Integer]</span><span class='hs-varid'>rm</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Integer.Type.Integer -&gt; GHC.Types.Bool)
-&gt; x3:[GHC.Integer.Type.Integer]
-&gt; {v : [GHC.Integer.Type.Integer] | len v &lt;= len x3}</span><span class='hs-varid'>filter</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Types.Bool | Prop v &lt;=&gt; x1 &lt;= v}</span><span class='hs-varop'>&lt;=</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == n}</span><span class='hs-varid'>n</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Integer.Type.Integer] | len v &gt;= 0}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Integer.Type.Integer | v == x1 + x2}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Integer.Type.Integer | v == x1 + x2}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-num'>2</span></a><a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Integer.Type.Integer | x1 &gt; 0 &amp;&amp; x2 &gt; 0 =&gt; v &gt;= x1 &amp;&amp; v &gt;= x2 &amp;&amp; x1 &gt; 1 &amp;&amp; x2 &gt; 1 =&gt; v &gt; x1 &amp;&amp; v &gt; x2 &amp;&amp; x1 == 0 || x2 == 0 =&gt; v == 0}</span><span class='hs-varop'>*</span></a><a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-varid'>x</span></a><a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Integer.Type.Integer | x1 &gt; 0 &amp;&amp; x2 &gt; 0 =&gt; v &gt;= x1 &amp;&amp; v &gt;= x2 &amp;&amp; x1 &gt; 1 &amp;&amp; x2 &gt; 1 =&gt; v &gt; x1 &amp;&amp; v &gt; x2 &amp;&amp; x1 == 0 || x2 == 0 =&gt; v == 0}</span><span class='hs-varop'>*</span></a><a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>x</span><span class='hs-keyglyph'>&lt;-</span><a class=annot href="#"><span class=annottext>{v : [GHC.Integer.Type.Integer] | len v &gt;= 0}</span><span class='hs-keyglyph'>[</span></a><span class='hs-num'>1</span><span class='hs-keyglyph'>..</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == n}</span><span class='hs-varid'>n</span></a><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>&lt;-</span><a class=annot href="#"><span class=annottext>{v : [GHC.Integer.Type.Integer] | len v &gt;= 0}</span><span class='hs-keyglyph'>[</span></a><span class='hs-num'>1</span><span class='hs-keyglyph'>..</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == n}</span><span class='hs-varid'>n</span></a><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Integer.Type.Integer
-&gt; x2:GHC.Integer.Type.Integer
-&gt; {v : GHC.Types.Bool | Prop v &lt;=&gt; x1 &lt;= v}</span><span class='hs-varop'>&lt;=</span></a> <a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-varid'>y</span></a><span class='hs-keyglyph'>]</span>
</pre>
</body>
</html>