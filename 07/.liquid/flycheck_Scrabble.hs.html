<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/Users/matt/Dropbox/cis194/07/flycheck_Scrabble.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><span class='hs-comment'>{-# LANGUAGE GeneralizedNewtypeDeriving, FlexibleInstances #-}</span>
<span class=hs-linenum> 2: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Scrabble</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 3: </span>
<span class=hs-linenum> 4: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Char</span> <span class='hs-layout'>(</span><span class='hs-varid'>toLower</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 5: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Monoid</span>
<span class=hs-linenum> 6: </span>
<span class=hs-linenum> 7: </span><span class='hs-keyword'>newtype</span> <span class='hs-conid'>Score</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Score</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(GHC.Classes.Eq Scrabble.Score)</span><span class='hs-conid'>Eq</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Classes.Ord Scrabble.Score)</span><span class='hs-conid'>Ord</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Show.Show Scrabble.Score)</span><span class='hs-conid'>Show</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Num.Num Scrabble.Score)</span><span class='hs-conid'>Num</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 8: </span>
<span class=hs-linenum> 9: </span><a class=annot href="#"><span class=annottext>Scrabble.Score -&gt; GHC.Types.Int</span><span class='hs-definition'>getScore</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Score</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>s</span>
<span class=hs-linenum>10: </span>
<span class=hs-linenum>11: </span><span class='hs-keyword'>instance</span> <a class=annot href="#"><span class=annottext>(Data.Monoid.Monoid Scrabble.Score)</span><span class='hs-conid'>Monoid</span></a> <span class='hs-conid'>Score</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>12: </span>  <a class=annot href="#"><span class=annottext>Scrabble.Score</span><span class='hs-varid'>mempty</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; Scrabble.Score</span><span class='hs-conid'>Score</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (0  :  int)}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>13: </span>  <a class=annot href="#"><span class=annottext>x1:Scrabble.Score
-&gt; x2:Scrabble.Score -&gt; {v : Scrabble.Score | v == x1 + x2}</span><span class='hs-varid'>mappend</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:Scrabble.Score
-&gt; x2:Scrabble.Score -&gt; {v : Scrabble.Score | v == x1 + x2}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>+</span><span class='hs-layout'>)</span>
<span class=hs-linenum>14: </span>
<span class=hs-linenum>15: </span><a class=annot href="#"><span class=annottext>[GHC.Types.Int]</span><span class='hs-definition'>charWeights</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Int] | null v &lt;=&gt; false &amp;&amp; len v &gt;= 0}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (1  :  int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (3  :  int)}</span><span class='hs-num'>3</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (3  :  int)}</span><span class='hs-num'>3</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (2  :  int)}</span><span class='hs-num'>2</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (1  :  int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (4  :  int)}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (2  :  int)}</span><span class='hs-num'>2</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (4  :  int)}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (1  :  int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (8  :  int)}</span><span class='hs-num'>8</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (5  :  int)}</span><span class='hs-num'>5</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (1  :  int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (3  :  int)}</span><span class='hs-num'>3</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (1  :  int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (1  :  int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (3  :  int)}</span><span class='hs-num'>3</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (10  :  int)}</span><span class='hs-num'>10</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (1  :  int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (1  :  int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (1  :  int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (1  :  int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (4  :  int)}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (4  :  int)}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (8  :  int)}</span><span class='hs-num'>8</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (4  :  int)}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (10  :  int)}</span><span class='hs-num'>10</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>16: </span>
<span class=hs-linenum>17: </span><span class='hs-definition'>score</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Char</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Score</span>
<span class=hs-linenum>18: </span><a class=annot href="#"><span class=annottext>GHC.Types.Char -&gt; Scrabble.Score</span><span class='hs-definition'>score</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Char</span><span class='hs-varid'>c</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>{v : [(GHC.Types.Char, GHC.Types.Int)] | len v &lt;= len Scrabble.charWeights}</span><span class='hs-varid'>scoreTable</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[GHC.Types.Char]
-&gt; x2:[GHC.Types.Int]
-&gt; {v : [(GHC.Types.Char, GHC.Types.Int)] | len x1 == len x2 =&gt; len v == len x1 &amp;&amp; len v &lt;= len x1 &amp;&amp; len v &lt;= len x2}</span><span class='hs-varid'>zip</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | len v &gt;= 0}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Char</span><span class='hs-chr'>'a'</span></a><span class='hs-keyglyph'>..</span><a class=annot href="#"><span class=annottext>GHC.Types.Char</span><span class='hs-chr'>'z'</span></a><span class='hs-keyglyph'>]</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Int] | v == Scrabble.charWeights &amp;&amp; len v &gt;= 0}</span><span class='hs-varid'>charWeights</span></a> <span class='hs-keyword'>in</span>
<span class=hs-linenum>19: </span>  <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>GHC.Types.Char
-&gt; [(GHC.Types.Char, GHC.Types.Int)]
-&gt; (Data.Maybe.Maybe GHC.Types.Int)</span><span class='hs-varid'>lookup</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Char -&gt; GHC.Types.Char</span><span class='hs-varid'>toLower</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Char | v == c}</span><span class='hs-varid'>c</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [(GHC.Types.Char, GHC.Types.Int)] | v == scoreTable &amp;&amp; len v &gt;= 0 &amp;&amp; len v &lt;= len Scrabble.charWeights}</span><span class='hs-varid'>scoreTable</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum>20: </span>    <span class='hs-conid'>Just</span> <span class='hs-varid'>s</span>  <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; Scrabble.Score</span><span class='hs-conid'>Score</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == s}</span><span class='hs-varid'>s</span></a>
<span class=hs-linenum>21: </span>    <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; Scrabble.Score</span><span class='hs-conid'>Score</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (0  :  int)}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>22: </span>
<span class=hs-linenum>23: </span><span class='hs-definition'>scoreString</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Score</span>
<span class=hs-linenum>24: </span><a class=annot href="#"><span class=annottext>[GHC.Types.Char] -&gt; Scrabble.Score</span><span class='hs-definition'>scoreString</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[Scrabble.Score] -&gt; Scrabble.Score</span><span class='hs-varid'>mconcat</span></a> <a class=annot href="#"><span class=annottext>([Scrabble.Score] -&gt; Scrabble.Score)
-&gt; ([GHC.Types.Char] -&gt; [Scrabble.Score])
-&gt; [GHC.Types.Char]
-&gt; exists [[Scrabble.Score]].Scrabble.Score</span><span class='hs-varop'>.</span></a> <a class=annot href="#"><span class=annottext>(GHC.Types.Char -&gt; Scrabble.Score)
-&gt; x3:[GHC.Types.Char] -&gt; {v : [Scrabble.Score] | len v == len x3}</span><span class='hs-varid'>map</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Char -&gt; Scrabble.Score</span><span class='hs-varid'>score</span></a>
<span class=hs-linenum>25: </span>
<span class=hs-linenum>26: </span><span class='hs-comment'>--scoreString = foldl mappend mempty . map score</span>
</pre>
</body>
</html>